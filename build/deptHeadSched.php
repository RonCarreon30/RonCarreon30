<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLV: RESERVA</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="flex h-screen bg-gray-100">
        <!-- Sidebar Component Start -->
        <div class="flex flex-col items-center w-16 h-full overflow-hidden text-blue-200 bg-plv-blue rounded-r-lg">
            <a class="flex items-center justify-center mt-3" href="#">
                <img class="w-8 h-8" src="img/PLV Logo.png" alt="Logo">
            </a>
            <div class="flex flex-col items-center mt-3 border-t border-gray-700">
                <a class="flex items-center justify-center w-12 h-12 mt-2 rounded hover:bg-persian-blue" href="deptHeadDashboard.php">
                    <svg class="w-6 h-6 stroke-current" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                    </svg>
                </a>
                <a class="flex items-center justify-center w-12 h-12 mt-2 rounded hover:bg-persian-blue" href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z" />
                      </svg>
                                          
                </a>
                <a class="flex items-center justify-center w-12 h-12 mt-2 rounded hover:bg-persian-blue" href="deptHeadSched.html">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5" />
                    </svg>                      
                </a>
            </div>
            <div class="flex flex-col items-center mt-2 border-t border-gray-700">
                <a class="flex items-center justify-center w-12 h-12 mt-2 rounded hover:bg-persian-blue" href="#">
                    <svg class="w-6 h-6 stroke-current"  xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4" />
                    </svg>
                </a>
                <a class="relative flex items-center justify-center w-12 h-12 mt-2 rounded hover:bg-persian-blue" href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0M3.124 7.5A8.969 8.969 0 0 1 5.292 3m13.416 0a8.969 8.969 0 0 1 2.168 4.5" />
                      </svg>
                      
                    <span class="absolute top-0 left-0 w-2 h-2 mt-2 ml-2 bg-plv-highlight rounded-full"></span>
                </a>
            </div>
                <!-- Trigger the custom confirmation dialog -->
                <a class="flex items-center justify-center w-16 h-16 mt-auto bg-persian-blue hover:bg-plv-highlight" href="#" onclick="showCustomDialog()">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9" />
                    </svg>
                </a>
        </div>
        <!-- Component End  -->

        <!-- Content area -->
        <div class="flex flex-col flex-1">
            <!-- Header -->
            <header class="bg-white shadow-lg">
                <div class="flex items-center justify-between px-6 py-3 border-b">
                    <h2 class="text-lg font-semibold">Room Loading</h2>
                    <!-- Add any header content here -->
                </div>
            </header>
<!-- Main content area -->
<main class="flex-1 p-4">
                <!-- Search and List of Facilities-->
                <div class="flex h-[560px] flex-row items-center space-x-4">
                    <div id="building-list" class="flex h-full w-full flex-col space-y-2 p-2">
                        <!-- Search Input -->
                        <div class="mb-4">
                            <input type="text" id="searchInput" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-400" placeholder="Search Room">
                        </div>
                        <h1 class="text-lg font-semibold">Building List</h1>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="buildingContainer">
                        <!-- Building list content -->
                        <?php
                        // Include your database connection file here
                        include 'config.php';

                        // Query to select distinct building names from the rooms table
                        $sql = "SELECT DISTINCT building FROM rooms";

                        // Execute the query
                        $result = $conn->query($sql);

                        // Check if there are rows returned
                        if ($result->num_rows > 0) {
                            // Loop through each row to display building cards
                            while ($row = $result->fetch_assoc()) {
                                echo "<div class='p-4 bg-white border rounded-md shadow-md'>";
                                echo "<h2 class='text-lg font-semibold text-gray-900 mb-2'>" . $row["building"] . " Building: </h2>";
                                echo "<button class='bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 view-rooms-btn' data-building='" . $row["building"] . "'>View Rooms</button>";
                                echo "</div>";
                            }
                        } else {
                            // If no rows returned, display a message
                            echo "<div class='p-4 bg-white border rounded-md shadow-md'>";
                            echo "<p class='text-gray-900'>No buildings found.</p>";
                            echo "</div>";
                        }

                        // Close the database connection
                        $conn->close();
                        ?>
                        </div>
                    </div>

                    <!-- Room list (initially hidden) -->
                    <div id="room-list" class="hidden flex h-full w-full flex-col space-y-2">
                        <!-- Search Input -->
                        <div class="flex items-center">
                            <!-- Back button for room list -->
                            <a class="flex items-center justify-center w-12 h-12 rounded hover:bg-persian-blue" href="#" onclick="window.location.reload()">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-6 h-6">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                                </svg>
                            </a>
                            <!-- Search Input -->
                            <input type="text" id="searchInput" class="ml-4 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-400" placeholder="Search Room">
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="roomContainer">

                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

<!-- Modal for class schedule input -->
<div id="myModal" class="modal hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center ">
    <div class="modal-content bg-white p-6 rounded-lg shadow-lg w-1/2">
        <span class="close cursor-pointer absolute top-0 right-0 p-4">&times;</span>
        <h2 class="text-lg font-semibold text-gray-900 mb-4">Enter Class Schedule</h2>
        <form id="classScheduleForm" class="grid grid-cols-2 gap-2" action="create_schedule.php" method="POST">

            <!-- Days checkboxes -->
            <div class="col-span-2 mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Day(s)</label><br>
                <input type="checkbox" id="monday" name="day" value="monday">
                <label for="monday">Monday</label>
                <input type="checkbox" id="tuesday" name="day" value="tuesday">
                <label for="tuesday">Tuesday</label>
                <input type="checkbox" id="wednesday" name="day" value="wednesday">
                <label for="tuesday">Wednesday</label>
                <input type="checkbox" id="thursday" name="day" value="thursday">
                <label for="tuesday">Thursday</label>
                <input type="checkbox" id="friday" name="day" value="friday">
                <label for="tuesday">Friday</label>
                <input type="checkbox" id="saturday" name="day" value="saturday">
                <label for="tuesday">Saturday</label>
                <!-- Add checkboxes for other days -->
            </div>
             <!-- Time Start and Time End -->
             <div>
                <label for="startTime" class="block text-sm font-medium text-gray-700">Time Start</label>
                <select id="startTime" name="startTime" class="mt-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-400" required>
                    <!-- JavaScript will dynamically generate options -->
                </select>
            </div>
            <div>
                <label for="endTime" class="block text-sm font-medium text-gray-700">Time End</label>
                <select id="endTime" name="endTime" class="mt-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-400" required>
                    <!-- JavaScript will dynamically generate options -->
                </select>
            </div>
            <!-- Academic Year and Semester -->
            <div>
                <label for="academicYear" class="block text-sm font-medium text-gray-700">Academic Year</label>
                <input type="text" id="academicYear" name="academicYear" class="mt-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-400" placeholder="Enter academic year" required>
            </div>
            <div>
                <label for="semester" class="block text-sm font-medium text-gray-700">Semester</label>
                <input type="text" id="semester" name="semester" class="mt-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-400" placeholder="Enter semester" required>
            </div>
            <!-- Year Level and Course -->
            <div>
                <label for="courseYear" class="block text-sm font-medium text-gray-700">Year Level</label>
                <input type="text" id="courseYear" name="courseYear" class="mt-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-400" placeholder="Enter year level" required>
            </div>
            <div>
                <label for="course" class="block text-sm font-medium text-gray-700">Course</label>
                <input type="text" id="course" name="course" class="mt-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-400" placeholder="Enter course" required>
            </div>
            <!-- Section and Subject -->
            <div>
                <label for="section" class="block text-sm font-medium text-gray-700">Section</label>
                <input type="text" id="section" name="section" class="mt-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-400" placeholder="Enter section" required>
            </div>
            <div>
                <label for="subject" class="block text-sm font-medium text-gray-700">Subject</label>
                <input type="text" id="subject" name="subject" class="mt-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-400" placeholder="Enter subject" required>
            </div>
            <!-- Teacher and Room -->
            <div>
                <label for="teacher" class="block text-sm font-medium text-gray-700">Teacher</label>
                <input type="text" id="teacher" name="teacher" class="mt-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-400" placeholder="Enter teacher" required>
            </div>
            <div class="col-span-2">
                <label for="room" class="block text-sm font-medium text-gray-700">Room</label>
                <input type="text" id="room" name="room" class="mt-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-blue-400" placeholder="Enter room" readonly required>
            </div>
            <!-- Submit Button -->
            <button type="submit" onclick="SubmitSchedForm()" class="col-span-2 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600">Submit</button>
        </form>
    </div>
</div>


    <!-- HTML for custom confirmation dialog -->
    <div id="custom-dialog" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
        <div class="bg-white p-6 rounded-lg shadow-lg w-11/12 max-w-md flex flex-col items-center">
            <img class="w-36 mb-4" src="img/undraw_warning_re_eoyh.svg" alt="">
            <p class="text-lg text-slate-700 font-semibold mb-4">Are you sure you want to logout?</p>
            <div class="flex justify-center mt-5">
                <button onclick="cancelLogout()" class="mr-4 px-4 py-2 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400">Cancel</button>
                <button onclick="confirmLogout()" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-500">Logout</button>
            </div>
        </div>
    </div>

    <script src="scripts/logout.js"></script>
    <script src="scripts/functions.js"></script>
    <script>
document.addEventListener("DOMContentLoaded", function() {
    // Get all "View Rooms" buttons
    const viewRoomButtons = document.querySelectorAll(".view-rooms-btn");

    // Add click event listener to each button
    viewRoomButtons.forEach(button => {
        button.addEventListener("click", function() {
            // Show the room list div
            document.getElementById("room-list").classList.remove("hidden");
            // Hide the building list div
            document.getElementById("building-list").classList.add("hidden");
            // Get the building name associated with the clicked button
            const buildingName = button.getAttribute("data-building");
            // Fetch rooms associated with the buildingName and display them
            fetchRooms(buildingName);
        });
    });

    // Function to fetch and display rooms associated with the building
    function fetchRooms(buildingName) {
        // Make an AJAX request to fetch rooms associated with the buildingName
        fetch('fetch_rooms.php?building=' + encodeURIComponent(buildingName))
            .then(response => response.json())
            .then(data => {
                // Clear existing room list
                const roomList = document.getElementById('roomContainer');
                roomList.innerHTML = '';

                // Create HTML elements for each room
                data.forEach(room => {
                    const roomCard = document.createElement('div');
                    const roomId = `room-${room}`; // Generate a unique id for each room
                    roomCard.setAttribute('id', roomId); // Set the id attribute
                    roomCard.classList.add('p-4', 'bg-white', 'border', 'rounded-md', 'shadow-md', 'hover:bg-gray-200', 'room'); // Add 'room' class to each room
                    roomCard.innerHTML = `
                        <h2 class='text-lg font-semibold text-gray-900 mb-2 room-number'>Room Number: ${room}</h2>
                    `;
                    roomList.appendChild(roomCard);

                    // Add click event listener to each room
                    roomCard.addEventListener('click', function() {
                        // Get the room number
                        const roomNumber = roomCard.querySelector(".room-number").textContent;
                        // Set the room field value to the room number
                        document.getElementById("room").value = roomNumber;
                        // Show the modal
                        document.getElementById("myModal").classList.remove("hidden");
                    });
                });
            })
            .catch(error => console.error('Error fetching rooms:', error));
    }
});
    document.addEventListener("DOMContentLoaded", function() {
    // Get all room elements
    const rooms = document.querySelectorAll(".room");

    // Add click event listener to each room
    rooms.forEach(room => {
        room.addEventListener("click", function() {
            // Show the modal
            document.getElementById("myModal").classList.remove("hidden");
        });
    });

    // Get the <span> element that closes the modal
    const closeBtn = document.querySelector(".close");

    // When the user clicks on <span> (x), close the modal
    closeBtn.addEventListener("click", function() {
        document.getElementById("myModal").classList.add("hidden");
    });

    // When the user clicks anywhere outside of the modal, close it
    window.addEventListener("click", function(event) {
        if (event.target === document.getElementById("myModal")) {
            document.getElementById("myModal").classList.add("hidden");
        }
    });

    // Prevent the modal from closing when clicking inside it
    const modalContent = document.querySelector(".modal-content");
    modalContent.addEventListener("click", function(event) {
        event.stopPropagation();
    });

    // Handle form submission
    const form = document.getElementById("classScheduleForm");
    form.addEventListener("submit", function(event) {   
        // Add your form submission logic here
        // You can retrieve form data using form.elements
        const className = form.elements["className"].value;
        console.log("Class Name:", className);
        // Close the modal after form submission
        document.getElementById("myModal").classList.add("hidden");
    });
});
// Function to generate time options with 30-minute intervals from 7:00 AM to 8:30 PM
    function generateTimeOptions() {
        const selectStartTime = document.getElementById("startTime");
        const selectEndTime = document.getElementById("endTime");

        // Clear existing options
        selectStartTime.innerHTML = '';
        selectEndTime.innerHTML = '';

        // Start time options
        for (let hour = 7; hour <= 20; hour++) {
            for (let minute = 0; minute < 60; minute += 30) {
                const suffix = hour < 12 ? 'AM' : 'PM';
                const displayHour = hour % 12 || 12; // Convert hour to 12-hour format
                const time = `${displayHour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')} ${suffix}`;
                const option = new Option(time, time);
                selectStartTime.add(option);
            }
        }

        // End time options
        for (let hour = 7; hour <= 20; hour++) {
            for (let minute = 0; minute < 60; minute += 30) {
                const suffix = hour < 12 ? 'AM' : 'PM';
                const displayHour = hour % 12 || 12; // Convert hour to 12-hour format
                const time = `${displayHour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')} ${suffix}`;
                const option = new Option(time, time);
                selectEndTime.add(option);
            }
        }
    }

    // Call the function to generate time options when the document is loaded
    document.addEventListener("DOMContentLoaded", function() {
        generateTimeOptions();
    });
        // Check if success parameter exists in URL
        const urlParams = new URLSearchParams(window.location.search);
    const success = urlParams.get('success');

    // Display success message if success parameter exists
    if (success === '1') {
        alert('Record inserted successfully!');
    }
    </script>

</body>
</html>